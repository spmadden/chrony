__no_system_clock_control() {
    if ! dpkg-vendor --derives-from Ubuntu; then
        sed -i '/^DAEMON_OPTS=/s/"\(.*\)"/"\1 -x"/' /etc/default/chrony
        mkdir -p /etc/systemd/system/chrony.service.d
        cat <<EOF > /etc/systemd/system/chrony.service.d/override.conf
[Unit]
ConditionCapability=
EOF
        systemctl daemon-reload && systemctl --quiet restart chrony.service
    fi
}

__test_fail() {
    printf 'FAIL\n' >&2
    return 1
}

__test_ok() {
    printf 'OK\n'
    return 0
}

__test_skip() {
    [ -n "$1" ] && printf 'SKIP: (%s)\n' "$1" || printf 'SKIP\n'
    exit 77
}
